<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Công cụ tính thuế thu nhập cá nhân 2026 - So sánh luật cũ và mới">
    <title>Tính Lương & Thuế TNCN 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            /* ========================================
               COOL NEUTRALS - Slate Scale
               ======================================== */
            --slate-50: #F8FAFC;
            --slate-100: #F1F5F9;
            --slate-200: #E2E8F0;
            --slate-300: #CBD5E1;
            --slate-400: #94A3B8;
            --slate-500: #64748B;
            --slate-600: #475569;
            --slate-700: #334155;
            --slate-800: #1E293B;
            --slate-900: #0F172A;

            /* ========================================
               ACCENT - Emerald (Primary Interactive)
               ======================================== */
            --emerald-50: #ECFDF5;
            --emerald-100: #D1FAE5;
            --emerald-200: #A7F3D0;
            --emerald-400: #34D399;
            --emerald-500: #10B981;
            --emerald-600: #059669;
            --emerald-700: #047857;
            --emerald-800: #065F46;

            /* ========================================
               STATUS COLORS
               ======================================== */
            --amber-500: #F59E0B;
            --rose-500: #F43F5E;

            /* ========================================
               SEMANTIC TOKENS
               ======================================== */
            --bg-page: #FAFAF8;
            --bg-card: #FFFFFF;
            --bg-elevated: #FFFFFF;
            --border-default: rgba(0, 0, 0, 0.06);
            --border-subtle: rgba(0, 0, 0, 0.04);

            --text-primary: var(--slate-900);
            --text-secondary: var(--slate-600);
            --text-muted: var(--slate-400);

            /* ========================================
               SPACING & RADII
               ======================================== */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;

            /* ========================================
               SHADOWS - Layered & Warm
               ======================================== */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.04);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.05), 0 2px 4px rgba(0, 0, 0, 0.04);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.06), 0 4px 8px rgba(0, 0, 0, 0.04);
            --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.08), 0 8px 16px rgba(0, 0, 0, 0.04);
            --shadow-emerald: 0 4px 16px rgba(16, 185, 129, 0.25);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, sans-serif;
            background: var(--bg-page);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ========================================
           HEADER
           ======================================== */
        .site-header {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-default);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.9);
        }

        .header-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-mark {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--emerald-500), var(--emerald-600));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: var(--shadow-emerald);
        }

        .logo-mark svg {
            width: 20px;
            height: 20px;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }

        .logo-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 500;
        }

        .header-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--emerald-50);
            color: var(--emerald-700);
            font-size: 12px;
            font-weight: 600;
            border-radius: 100px;
            border: 1px solid var(--emerald-100);
        }

        .header-badge::before {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--emerald-500);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(0.9); }
        }

        /* ========================================
           MAIN LAYOUT
           ======================================== */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px;
            display: grid;
            grid-template-columns: 360px 1fr;
            gap: 32px;
            align-items: start;
        }

        @media (max-width: 1024px) {
            main {
                grid-template-columns: 1fr;
                padding: 20px;
            }
        }

        /* ========================================
           INPUT SECTION
           ======================================== */
        .input-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
            position: sticky;
            top: 100px;
        }

        @media (max-width: 1024px) {
            .input-section {
                position: static;
            }
        }

        .card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-default);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            transition: box-shadow 0.3s ease, transform 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-body {
            padding: 24px;
        }

        /* Input Groups */
        .input-group {
            margin-bottom: 24px;
        }

        .input-group:last-child {
            margin-bottom: 0;
        }

        .input-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .input-label svg {
            width: 14px;
            height: 14px;
            opacity: 0.7;
        }

        .input-wrapper {
            position: relative;
        }

        .input-field {
            width: 100%;
            padding: 16px 20px;
            padding-right: 70px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            font-weight: 700;
            border: 2px solid var(--border-default);
            border-radius: var(--radius-lg);
            background: var(--bg-card);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .input-field:hover {
            border-color: var(--slate-300);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--emerald-500);
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        .input-field::placeholder {
            color: var(--slate-300);
            font-weight: 600;
        }

        .input-suffix {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            font-weight: 700;
            color: var(--emerald-700);
            background: var(--emerald-50);
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            letter-spacing: 0.02em;
        }

        .input-hint {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 8px;
        }

        /* Counter */
        .counter-control {
            display: inline-flex;
            align-items: stretch;
            border: 2px solid var(--border-default);
            border-radius: var(--radius-md);
            overflow: hidden;
            background: var(--bg-card);
        }

        .counter-btn {
            width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
        }

        .counter-btn:hover {
            background: var(--slate-100);
            color: var(--emerald-600);
        }

        .counter-btn:active {
            background: var(--slate-200);
        }

        .counter-btn svg {
            width: 16px;
            height: 16px;
        }

        .counter-input {
            width: 56px;
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 18px;
            font-weight: 700;
            border: none;
            border-left: 1px solid var(--border-default);
            border-right: 1px solid var(--border-default);
            background: transparent;
            color: var(--text-primary);
            padding: 12px 0;
            -moz-appearance: textfield;
        }

        .counter-input::-webkit-outer-spin-button,
        .counter-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }

        .counter-input:focus {
            outline: none;
        }

        /* Region Grid */
        .region-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .region-option {
            position: relative;
            padding: 16px;
            border: 2px solid var(--border-default);
            border-radius: var(--radius-lg);
            background: var(--bg-card);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .region-option:hover {
            border-color: var(--slate-300);
            background: var(--slate-50);
        }

        .region-option.active {
            border-color: var(--emerald-500);
            background: linear-gradient(135deg, var(--emerald-50) 0%, rgba(255,255,255,1) 100%);
            box-shadow: var(--shadow-emerald);
        }

        .region-option input {
            position: absolute;
            opacity: 0;
        }

        .region-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .region-name {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .region-option.active .region-name {
            color: var(--emerald-700);
        }

        .region-radio {
            width: 20px;
            height: 20px;
            border: 2px solid var(--slate-300);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            background: white;
        }

        .region-option.active .region-radio {
            border-color: var(--emerald-500);
            background: var(--emerald-500);
        }

        .region-radio::after {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            transform: scale(0);
            transition: all 0.15s ease;
        }

        .region-option.active .region-radio::after {
            opacity: 1;
            transform: scale(1);
        }

        .region-amount {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .region-option.active .region-amount {
            color: var(--emerald-600);
        }

        /* Info Banner */
        .info-banner {
            background: linear-gradient(135deg, var(--emerald-50) 0%, rgba(236, 253, 245, 0.5) 100%);
            border: 1px solid var(--emerald-100);
            border-radius: var(--radius-lg);
            padding: 16px 20px;
            display: flex;
            gap: 14px;
            align-items: flex-start;
        }

        .info-banner-icon {
            width: 32px;
            height: 32px;
            background: var(--emerald-500);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }

        .info-banner-icon svg {
            width: 16px;
            height: 16px;
        }

        .info-banner-content h4 {
            font-size: 13px;
            font-weight: 700;
            color: var(--emerald-800);
            margin-bottom: 2px;
        }

        .info-banner-content p {
            font-size: 13px;
            color: var(--emerald-700);
            line-height: 1.5;
        }

        /* ========================================
           RESULTS SECTION
           ======================================== */
        .results-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 640px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        .result-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-default);
            padding: 28px;
            position: relative;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .result-card--highlight {
            border: 2px solid var(--emerald-400);
            background: linear-gradient(160deg, #ffffff 0%, var(--emerald-50) 100%);
            box-shadow: var(--shadow-emerald);
        }

        .result-card--highlight::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--emerald-400), var(--emerald-500), var(--emerald-600));
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }

        .result-card--highlight:hover {
            border-color: var(--emerald-500);
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.2);
        }

        .result-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            padding: 6px 14px;
            border-radius: 100px;
            margin-bottom: 20px;
        }

        .result-badge--default {
            background: var(--slate-100);
            color: var(--slate-600);
        }

        .result-badge--success {
            background: var(--emerald-500);
            color: white;
        }

        .result-badge--success::before {
            content: '';
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
        }

        .result-label {
            font-size: 13px;
            color: var(--text-muted);
            font-weight: 500;
            margin-bottom: 6px;
        }

        .result-amount {
            font-family: 'JetBrains Mono', monospace;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 20px;
            letter-spacing: -0.02em;
        }

        .result-card--default .result-amount {
            color: var(--text-primary);
        }

        .result-card--highlight .result-amount {
            color: var(--emerald-600);
        }

        .result-amount .currency {
            font-size: 24px;
            opacity: 0.6;
            margin-left: 2px;
        }

        .result-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding-top: 16px;
            border-top: 1px solid var(--border-subtle);
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }

        .result-row-label {
            color: var(--text-muted);
        }

        .result-row-value {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 13px;
        }

        .result-card--default .result-row-value {
            color: var(--text-primary);
        }

        .result-card--highlight .result-row-value {
            color: var(--emerald-600);
        }

        /* Savings Box */
        .savings-box {
            margin-top: 16px;
            padding: 12px 16px;
            background: linear-gradient(135deg, var(--emerald-500), var(--emerald-600));
            border-radius: var(--radius-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-emerald);
            position: relative;
            overflow: hidden;
        }

        .savings-box::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .savings-label {
            font-size: 13px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .savings-value {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            font-size: 18px;
            color: white;
        }

        .savings-value svg {
            width: 18px;
            height: 18px;
        }

        /* ========================================
           CHART SECTION
           ======================================== */
        .chart-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-default);
            padding: 28px;
            box-shadow: var(--shadow-md);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .chart-legend {
            display: flex;
            gap: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-dot--old {
            background: var(--slate-300);
        }

        .legend-dot--new {
            background: var(--emerald-500);
        }

        .chart-container {
            height: 180px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 80px;
            padding-bottom: 40px;
        }

        .chart-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .chart-bars {
            display: flex;
            gap: 8px;
            align-items: flex-end;
            height: 120px;
        }

        .chart-bar {
            width: 48px;
            border-radius: 6px 6px 0 0;
            position: relative;
            transition: height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .chart-bar--old {
            background: linear-gradient(180deg, var(--slate-300), var(--slate-400));
        }

        .chart-bar--new {
            background: linear-gradient(180deg, var(--emerald-400), var(--emerald-500));
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .chart-bar-value {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            white-space: nowrap;
            margin-bottom: 8px;
        }

        .chart-label {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* ========================================
           DETAILS SECTION
           ======================================== */
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .details-grid {
                grid-template-columns: 1fr;
            }
        }

        .detail-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-default);
            padding: 24px;
            box-shadow: var(--shadow-md);
        }

        .detail-card h3 {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .detail-card > p {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 20px;
        }

        .detail-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .detail-table th {
            text-align: left;
            padding: 12px 0;
            font-weight: 600;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border-default);
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .detail-table th:not(:first-child) {
            text-align: right;
        }

        .detail-table td {
            padding: 12px 0;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-subtle);
        }

        .detail-table td:not(:first-child) {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        .detail-table .text-green {
            color: var(--emerald-600);
            font-weight: 600;
        }

        .detail-table .text-red {
            color: var(--rose-500);
        }

        .detail-table .text-bold {
            font-weight: 700;
            color: var(--text-primary);
        }

        /* ========================================
           RESPONSIVE
           ======================================== */
        @media (max-width: 768px) {
            .header-inner {
                padding: 12px 16px;
            }

            .header-badge {
                display: none;
            }

            main {
                padding: 16px;
                gap: 20px;
            }

            .result-amount {
                font-size: 28px;
            }

            .chart-container {
                gap: 40px;
            }
        }

        /* ========================================
           ANIMATIONS
           ======================================== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card, .result-card, .chart-card, .detail-card {
            animation: fadeInUp 0.5s ease-out both;
        }

        .result-card:nth-child(2) { animation-delay: 0.1s; }
        .chart-card { animation-delay: 0.2s; }
        .detail-card:nth-child(1) { animation-delay: 0.3s; }
        .detail-card:nth-child(2) { animation-delay: 0.4s; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="header-inner">
            <div class="logo">
                <div class="logo-mark">
                    <i data-lucide="calculator"></i>
                </div>
                <div class="logo-text">
                    <span class="logo-title">Tính Thuế TNCN 2026</span>
                    <span class="logo-subtitle">So sánh luật cũ & mới</span>
                </div>
            </div>
            <div class="header-badge">Hiệu lực từ 1/1/2026</div>
        </div>
    </header>

    <main>
        <!-- Input Section -->
        <section class="input-section">
            <div class="card">
                <div class="card-body">
                    <!-- Salary Input -->
                    <div class="input-group">
                        <label class="input-label">Thu nhập Gross / Tháng</label>
                        <div class="input-wrapper">
                            <input
                                type="text"
                                id="salary"
                                class="input-field"
                                placeholder="0"
                                inputmode="numeric"
                                autocomplete="off"
                                autofocus>
                            <span class="input-suffix">VND</span>
                        </div>
                        <p class="input-hint">Tổng lương chưa trừ bảo hiểm và thuế</p>
                    </div>

                    <!-- Dependents -->
                    <div class="input-group">
                        <label class="input-label">
                            <i data-lucide="users"></i>
                            Số người phụ thuộc
                        </label>
                        <div class="counter-control">
                            <button type="button" class="counter-btn" data-action="decrement">
                                <i data-lucide="minus"></i>
                            </button>
                            <input
                                type="number"
                                id="dependents"
                                class="counter-input"
                                value="0"
                                min="0"
                                max="10">
                            <button type="button" class="counter-btn" data-action="increment">
                                <i data-lucide="plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Region -->
                    <div class="input-group">
                        <label class="input-label">Vùng lương tối thiểu</label>
                        <div class="region-grid" id="region-grid">
                            <label class="region-option active" data-region="I">
                                <input type="radio" name="region" value="I" checked>
                                <div class="region-header">
                                    <span class="region-name">Vùng I</span>
                                    <span class="region-radio"></span>
                                </div>
                                <div class="region-amount">5.310.000 đ</div>
                            </label>
                            <label class="region-option" data-region="II">
                                <input type="radio" name="region" value="II">
                                <div class="region-header">
                                    <span class="region-name">Vùng II</span>
                                    <span class="region-radio"></span>
                                </div>
                                <div class="region-amount">4.730.000 đ</div>
                            </label>
                            <label class="region-option" data-region="III">
                                <input type="radio" name="region" value="III">
                                <div class="region-header">
                                    <span class="region-name">Vùng III</span>
                                    <span class="region-radio"></span>
                                </div>
                                <div class="region-amount">4.140.000 đ</div>
                            </label>
                            <label class="region-option" data-region="IV">
                                <input type="radio" name="region" value="IV">
                                <div class="region-header">
                                    <span class="region-name">Vùng IV</span>
                                    <span class="region-radio"></span>
                                </div>
                                <div class="region-amount">3.700.000 đ</div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Info Banner -->
            <div class="info-banner">
                <div class="info-banner-icon">
                    <i data-lucide="sparkles"></i>
                </div>
                <div class="info-banner-content">
                    <h4>Mức giảm trừ mới (từ 1/1/2026)</h4>
                    <p>Bản thân: <strong>15.5 triệu</strong> · Người phụ thuộc: <strong>6.2 triệu</strong>/người</p>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="results-section">
            <!-- Result Cards -->
            <div class="results-grid">
                <!-- Old Law -->
                <div class="result-card result-card--default">
                    <span class="result-badge result-badge--default">Quy định cũ</span>
                    <div class="result-label">Thực lĩnh (Net)</div>
                    <div class="result-amount" id="old-net">0<span class="currency">đ</span></div>
                    <div class="result-details">
                        <div class="result-row">
                            <span class="result-row-label">Thuế phải đóng</span>
                            <span class="result-row-value" id="old-tax">0 đ</span>
                        </div>
                        <div class="result-row">
                            <span class="result-row-label">Tổng giảm trừ</span>
                            <span class="result-row-value" id="old-deduction">0 đ</span>
                        </div>
                    </div>
                </div>

                <!-- New Law -->
                <div class="result-card result-card--highlight">
                    <span class="result-badge result-badge--success">Quy định mới</span>
                    <div class="result-label">Thực lĩnh (Net)</div>
                    <div class="result-amount" id="new-net">0<span class="currency">đ</span></div>
                    <div class="result-details">
                        <div class="result-row">
                            <span class="result-row-label">Thuế phải đóng</span>
                            <span class="result-row-value" id="new-tax">0 đ</span>
                        </div>
                        <div class="result-row">
                            <span class="result-row-label">Tổng giảm trừ</span>
                            <span class="result-row-value" id="new-deduction">0 đ</span>
                        </div>
                    </div>
                    <div class="savings-box">
                        <span class="savings-label">Tiết kiệm được</span>
                        <span class="savings-value" id="savings-value">
                            0 đ
                            <i data-lucide="trending-up"></i>
                        </span>
                    </div>
                </div>
            </div>

            <!-- Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Biểu đồ so sánh</h3>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <span class="legend-dot legend-dot--old"></span>
                            Cũ
                        </div>
                        <div class="legend-item">
                            <span class="legend-dot legend-dot--new"></span>
                            Mới
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-group">
                        <div class="chart-bars">
                            <div class="chart-bar chart-bar--old" id="chart-tax-old" style="height: 0px;">
                                <span class="chart-bar-value" id="chart-tax-old-val">0</span>
                            </div>
                            <div class="chart-bar chart-bar--new" id="chart-tax-new" style="height: 0px;">
                                <span class="chart-bar-value" id="chart-tax-new-val">0</span>
                            </div>
                        </div>
                        <span class="chart-label">Thuế / tháng</span>
                    </div>
                    <div class="chart-group">
                        <div class="chart-bars">
                            <div class="chart-bar chart-bar--old" id="chart-net-old" style="height: 0px;">
                                <span class="chart-bar-value" id="chart-net-old-val">0</span>
                            </div>
                            <div class="chart-bar chart-bar--new" id="chart-net-new" style="height: 0px;">
                                <span class="chart-bar-value" id="chart-net-new-val">0</span>
                            </div>
                        </div>
                        <span class="chart-label">Thực lĩnh</span>
                    </div>
                </div>
            </div>

            <!-- Details -->
            <div class="details-grid">
                <div class="detail-card">
                    <h3>Chi tiết tính toán</h3>
                    <p id="region-info">Áp dụng vùng I - Mức lương tối thiểu 5.310.000 đ</p>
                    <table class="detail-table">
                        <thead>
                            <tr>
                                <th>Khoản mục</th>
                                <th>Cũ</th>
                                <th>Mới</th>
                            </tr>
                        </thead>
                        <tbody id="details-body"></tbody>
                    </table>
                </div>
                <div class="detail-card">
                    <h3>Chi tiết thuế lũy tiến</h3>
                    <p>Diễn giải theo từng bậc thuế suất</p>
                    <table class="detail-table">
                        <thead>
                            <tr>
                                <th>Bậc</th>
                                <th>Thuế suất</th>
                                <th>Cũ</th>
                                <th>Mới</th>
                            </tr>
                        </thead>
                        <tbody id="bracket-body"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <script>
        lucide.createIcons();

        // ========================================
        // Constants
        // ========================================

        const VND = {
            format: (n) => typeof n === 'number' && !isNaN(n) ? Math.round(n).toLocaleString('vi-VN') : '0',
            formatUnit: (n) => VND.format(n) + ' đ',
            formatShort: (n) => {
                if (n >= 1000000) return (n / 1000000).toFixed(1) + 'M';
                if (n >= 1000) return (n / 1000).toFixed(0) + 'K';
                return n.toString();
            },
            parse: (s) => parseInt(String(s).replace(/[^\d]/g, ''), 10) || 0
        };

        const TAX_OLD = {
            BRACKETS: [
                { upper: 5_000_000, rate: 0.05 },
                { upper: 10_000_000, rate: 0.10 },
                { upper: 18_000_000, rate: 0.15 },
                { upper: 32_000_000, rate: 0.20 },
                { upper: 52_000_000, rate: 0.25 },
                { upper: 80_000_000, rate: 0.30 },
                { upper: Infinity, rate: 0.35 }
            ],
            PERSONAL: 11_000_000,
            DEPENDENT: 4_400_000
        };

        const TAX_NEW = {
            BRACKETS: [
                { upper: 10_000_000, rate: 0.05 },
                { upper: 30_000_000, rate: 0.10 },
                { upper: 60_000_000, rate: 0.20 },
                { upper: 100_000_000, rate: 0.30 },
                { upper: Infinity, rate: 0.35 }
            ],
            PERSONAL: 15_500_000,
            DEPENDENT: 6_200_000
        };

        const REGIONS = {
            I: { min: 5_310_000, label: 'I' },
            II: { min: 4_730_000, label: 'II' },
            III: { min: 4_140_000, label: 'III' },
            IV: { min: 3_700_000, label: 'IV' }
        };

        const BASE_WAGE = 5_310_000;
        const CAP_MULT = 20;

        // ========================================
        // Calculations
        // ========================================

        function calcTax(income, brackets) {
            if (income <= 0) return 0;
            let tax = 0, prev = 0;
            for (const b of brackets) {
                if (income > b.upper) {
                    tax += (b.upper - prev) * b.rate;
                    prev = b.upper;
                } else {
                    tax += (income - prev) * b.rate;
                    break;
                }
            }
            return Math.round(tax);
        }

        function calcInsurance(gross, region) {
            const nationalCap = BASE_WAGE * CAP_MULT;
            const regionalCap = REGIONS[region].min * CAP_MULT;
            const si = Math.min(gross * 0.08, nationalCap * 0.08);
            const hi = Math.min(gross * 0.015, nationalCap * 0.015);
            const ui = Math.min(gross * 0.01, regionalCap * 0.01);
            return Math.round(si + hi + ui);
        }

        function grossToNet(gross, deps, region, tax) {
            const ins = calcInsurance(gross, region);
            const deduct = tax.PERSONAL + tax.DEPENDENT * deps;
            const taxable = Math.max(0, gross - ins - deduct);
            const taxAmt = calcTax(taxable, tax.BRACKETS);
            return { gross, ins, deduct, taxable, tax: taxAmt, net: Math.round(gross - ins - taxAmt) };
        }

        function getTaxBreakdown(income, brackets) {
            if (income <= 0) return [];
            const result = [];
            let prev = 0;
            for (let i = 0; i < brackets.length; i++) {
                const b = brackets[i];
                if (income > prev) {
                    const amt = Math.min(income - prev, b.upper - prev);
                    result.push({ rate: `${b.rate * 100}%`, tax: Math.round(amt * b.rate) });
                    prev = b.upper;
                    if (income <= b.upper) break;
                }
            }
            return result;
        }

        // ========================================
        // State & UI
        // ========================================

        const state = { salary: 0, deps: 0, region: 'I' };

        const $ = (id) => document.getElementById(id);
        const els = {
            salary: $('salary'),
            deps: $('dependents'),
            regionGrid: $('region-grid'),
            regionInfo: $('region-info'),
            oldNet: $('old-net'),
            oldTax: $('old-tax'),
            oldDeduct: $('old-deduction'),
            newNet: $('new-net'),
            newTax: $('new-tax'),
            newDeduct: $('new-deduction'),
            savings: $('savings-value'),
            details: $('details-body'),
            brackets: $('bracket-body'),
            chartTaxOld: $('chart-tax-old'),
            chartTaxNew: $('chart-tax-new'),
            chartNetOld: $('chart-net-old'),
            chartNetNew: $('chart-net-new'),
            chartTaxOldVal: $('chart-tax-old-val'),
            chartTaxNewVal: $('chart-tax-new-val'),
            chartNetOldVal: $('chart-net-old-val'),
            chartNetNewVal: $('chart-net-new-val')
        };

        function updateChart(oldR, newR) {
            const maxTax = Math.max(oldR.tax, newR.tax, 1);
            const maxNet = Math.max(oldR.net, newR.net, 1);
            const maxHeight = 100;

            els.chartTaxOld.style.height = Math.max(4, (oldR.tax / maxTax) * maxHeight) + 'px';
            els.chartTaxNew.style.height = Math.max(4, (newR.tax / maxTax) * maxHeight) + 'px';
            els.chartNetOld.style.height = Math.max(4, (oldR.net / maxNet) * maxHeight) + 'px';
            els.chartNetNew.style.height = Math.max(4, (newR.net / maxNet) * maxHeight) + 'px';

            els.chartTaxOldVal.textContent = VND.formatShort(oldR.tax);
            els.chartTaxNewVal.textContent = VND.formatShort(newR.tax);
            els.chartNetOldVal.textContent = VND.formatShort(oldR.net);
            els.chartNetNewVal.textContent = VND.formatShort(newR.net);
        }

        function update() {
            const oldR = grossToNet(state.salary, state.deps, state.region, TAX_OLD);
            const newR = grossToNet(state.salary, state.deps, state.region, TAX_NEW);
            const save = newR.net - oldR.net;
            const hasSalary = state.salary > 0;

            els.oldNet.innerHTML = `${VND.format(oldR.net)}<span class="currency">đ</span>`;
            els.oldTax.textContent = VND.formatUnit(oldR.tax);
            els.oldDeduct.textContent = hasSalary ? VND.formatUnit(oldR.deduct) : '0 đ';

            els.newNet.innerHTML = `${VND.format(newR.net)}<span class="currency">đ</span>`;
            els.newTax.textContent = VND.formatUnit(newR.tax);
            els.newDeduct.textContent = hasSalary ? VND.formatUnit(newR.deduct) : '0 đ';

            els.savings.innerHTML = `${VND.formatUnit(Math.max(0, save))} <i data-lucide="trending-up"></i>`;
            lucide.createIcons();

            // Region info
            els.regionInfo.textContent = `Áp dụng vùng ${state.region} - Mức lương tối thiểu ${VND.format(REGIONS[state.region].min)} đ`;

            // Chart
            updateChart(oldR, newR);

            // Details table
            const rows = [
                ['Lương Gross', oldR.gross, newR.gross],
                ['Bảo hiểm (10.5%)', -oldR.ins, -newR.ins],
                ['Giảm trừ bản thân', hasSalary ? -TAX_OLD.PERSONAL : 0, hasSalary ? -TAX_NEW.PERSONAL : 0],
                [`Giảm trừ NPT (×${state.deps})`, hasSalary ? -TAX_OLD.DEPENDENT * state.deps : 0, hasSalary ? -TAX_NEW.DEPENDENT * state.deps : 0],
                ['Thu nhập chịu thuế', oldR.taxable, newR.taxable],
                ['Thuế TNCN (*)', -oldR.tax, -newR.tax, 'negative'],
                ['Thực lĩnh (Net)', oldR.net, newR.net, 'bold']
            ];

            els.details.innerHTML = rows.map(([label, old, newVal, type]) => `
                <tr>
                    <td class="${type === 'bold' ? 'text-bold' : ''}">${label}</td>
                    <td class="${type === 'negative' ? 'text-red' : ''}">${VND.format(old)}</td>
                    <td class="text-green ${type === 'bold' ? 'text-bold' : ''}">${VND.format(newVal)}</td>
                </tr>
            `).join('');

            // Brackets table
            const oldBr = getTaxBreakdown(oldR.taxable, TAX_OLD.BRACKETS);
            const newBr = getTaxBreakdown(newR.taxable, TAX_NEW.BRACKETS);
            const rates = ['5%', '10%', '20%', '30%', '35%'];

            if (oldBr.length === 0 && newBr.length === 0) {
                els.brackets.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--text-muted);padding:20px">Không có thuế</td></tr>';
            } else {
                els.brackets.innerHTML = rates.map((r, i) => {
                    const o = oldBr.find(x => x.rate === r);
                    const n = newBr.find(x => x.rate === r);
                    return `
                        <tr>
                            <td>Bậc ${i + 1}</td>
                            <td>${r}</td>
                            <td>${o ? VND.format(o.tax) : '—'}</td>
                            <td class="text-green">${n ? VND.format(n.tax) : '—'}</td>
                        </tr>
                    `;
                }).join('');
            }
        }

        // ========================================
        // Events
        // ========================================

        let timeout;
        els.salary.addEventListener('input', (e) => {
            const val = e.target.value.replace(/[^\d]/g, '');
            const num = parseInt(val, 10) || 0;
            e.target.value = num > 0 ? num.toLocaleString('vi-VN') : '';
            state.salary = num;
            clearTimeout(timeout);
            timeout = setTimeout(update, 100);
        });

        document.querySelectorAll('.counter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                let v = parseInt(els.deps.value, 10) || 0;
                if (btn.dataset.action === 'increment' && v < 10) v++;
                if (btn.dataset.action === 'decrement' && v > 0) v--;
                els.deps.value = v;
                state.deps = v;
                update();
            });
        });

        els.deps.addEventListener('change', (e) => {
            state.deps = Math.max(0, Math.min(10, parseInt(e.target.value, 10) || 0));
            e.target.value = state.deps;
            update();
        });

        // Region selection
        els.regionGrid.querySelectorAll('.region-option').forEach(opt => {
            opt.addEventListener('click', () => {
                els.regionGrid.querySelectorAll('.region-option').forEach(o => o.classList.remove('active'));
                opt.classList.add('active');
                state.region = opt.dataset.region;
                update();
            });
        });

        update();

        // Export for testing
        window.VND = VND;
        window.grossToNet = grossToNet;
        window.calcTax = calcTax;
    </script>
</body>
</html>
